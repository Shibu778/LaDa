#################### INPUT FILE ####################
opti conv 
svectors
2.95796800         0.00000000        
0.00000000         6.48525389        
cartesian  
O    core         0.00000000        -1.62131347         6.26203703 -0.5368273
Ti   core         0.00000000         1.62131347         4.71793508 1.0238767
Ti   core         1.47898400        -1.62131347         5.22971431 0.9653684
O    core         1.47898400         2.83852852         5.09442801 -0.5188496
O    core         1.47898400         0.40409842         5.09442801 -0.5188496
O    core         0.00000000        -1.62131347         3.72605704 -0.4958999
O    core         0.00000000         1.62131347         2.94887724 -0.5390129
Ti   core         0.00000000        -1.62131347         1.94398262 1.1823552
Ti   core         1.47898400         1.62131347         1.49962861 1.1641808
O    core         1.47898400        -0.35587437         1.69370026 -0.5710973
O    core         1.47898400        -2.88675257         1.69370026 -0.5710973
O    core         0.00000000         1.62131347         0.40337225 -0.5841475
O    core         0.00000000        -1.62131347        -0.40337225 -0.584147
Ti   core         0.00000000         1.62131347        -1.94398262 1.1823554
Ti   core         1.47898400        -1.62131347        -1.49962861 1.1641812
O    core         1.47898400         2.88675257        -1.69370026 -0.5710974
O    core         1.47898400         0.35587437        -1.69370026 -0.5710974
O    core         0.00000000        -1.62131347        -2.94887724 -0.5390135
O    core         0.00000000         1.62131347        -3.72605704 -0.4958995
Ti   core         0.00000000        -1.62131347        -4.71793508 1.0238767
Ti   core         1.47898400         1.62131347        -5.22971431 0.9653683
O    core         1.47898400        -0.40409842        -5.09442801 -0.5188495
O    core         1.47898400        -2.83852852        -5.09442801 -0.5188495
O    core         0.00000000         1.62131347        -6.26203703 -0.5368275


morse
Ti core   Ti core     0.00567139 1.5543 4.18784 0.0 25.0
O core   O core     0.00567139 1.5543 4.18784 0.0 25.0
O core   Ti core     1.0279493 3.640737 1.88265 0.0 25.0
#################### END INPUT FILE ####################
#################### FUNCTIONAL ####################
from layered import QEqOptimizer

functional = QEqOptimizer()
functional.conv                        = True
functional.morse.enabled               = True
functional.morse['O|core', 'O|core']   = 0.00567139, 1.5543, 4.18784, 0, 25
functional.morse['O|core', 'Ti|core']  = 1.0279493, 3.640737, 1.88265, 0, 25
functional.morse['Ti|core', 'Ti|core'] = 0.00567139, 1.5543, 4.18784, 0, 25
functional.opti                        = True
functional.qeq                         = False
#################### END FUNCTIONAL ####################
********************************************************************************
*                       GENERAL UTILITY LATTICE PROGRAM                        *
*                                 Julian Gale                                  *
*                      Nanochemistry Research Institute                        *
*                           Department of Chemistry                            *
*                    Curtin University, Western Australia                      *
********************************************************************************
* Version = 4.0.3 * Last modified =  20th April 2012                           *
********************************************************************************
*  optimise     - perform optimisation run                                     *
*  conv         - constant volume calculation                                  *
********************************************************************************

  Job Started  at 11:51.58  3rd January    2013                               

  Number of CPUs =     1

  Host name      = nhpc15                                  


  Total number of configurations input =   1

********************************************************************************
*  Input for Configuration =   1                                               *
********************************************************************************

  Formula = O16Ti8                                                      

  Number of irreducible atoms/shells =      24


  Total number atoms/shells =      24

  Dimensionality = 2               :  Surface



  Surface Cartesian vectors (Angstroms) :

        2.957968    0.000000    0.000000
        0.000000    6.485254    0.000000

  Surface cell parameters (Angstroms/Degrees):

  a =       2.9580    alpha =  90.0000
  b =       6.4853

  Initial surface area   =     19.183173 Angs**2

  Initial surface dipole =      0.000000 e.Angs

  Temperature of configuration =  0.000     K 

  Mixed fractional/Cartesian coordinates of surface :

--------------------------------------------------------------------------------
   No.  Atomic       x           y          z         Charge      Occupancy
        Label      (Frac)      (Frac)     (Angs)        (e)         (Frac)  
--------------------------------------------------------------------------------
      1 O     c    0.000000 *  0.750000 *    6.2620 *  -0.53683    1.000000    
      2 Ti    c    0.000000 *  0.250000 *    4.7179 *   1.02388    1.000000    
      3 Ti    c    0.500000 *  0.750000 *    5.2297 *   0.96537    1.000000    
      4 O     c    0.500000 *  0.437690 *    5.0944 *  -0.51885    1.000000    
      5 O     c    0.500000 *  0.062310 *    5.0944 *  -0.51885    1.000000    
      6 O     c    0.000000 *  0.750000 *    3.7261 *  -0.49590    1.000000    
      7 O     c    0.000000 *  0.250000 *    2.9489 *  -0.53901    1.000000    
      8 Ti    c    0.000000 *  0.750000 *    1.9440 *   1.18236    1.000000    
      9 Ti    c    0.500000 *  0.250000 *    1.4996 *   1.16418    1.000000    
     10 O     c    0.500000 *  0.945126 *    1.6937 *  -0.57110    1.000000    
     11 O     c    0.500000 *  0.554874 *    1.6937 *  -0.57110    1.000000    
     12 O     c    0.000000    0.250000      0.4034    -0.58415    1.000000    
     13 O     c    0.000000 *  0.750000 *   -0.4034 *  -0.58415    1.000000    
     14 Ti    c    0.000000 *  0.250000 *   -1.9440 *   1.18236    1.000000    
     15 Ti    c    0.500000 *  0.750000 *   -1.4996 *   1.16418    1.000000    
     16 O     c    0.500000 *  0.445126 *   -1.6937 *  -0.57110    1.000000    
     17 O     c    0.500000 *  0.054874 *   -1.6937 *  -0.57110    1.000000    
     18 O     c    0.000000 *  0.750000 *   -2.9489 *  -0.53901    1.000000    
     19 O     c    0.000000 *  0.250000 *   -3.7261 *  -0.49590    1.000000    
     20 Ti    c    0.000000 *  0.750000 *   -4.7179 *   1.02388    1.000000    
     21 Ti    c    0.500000 *  0.250000 *   -5.2297 *   0.96537    1.000000    
     22 O     c    0.500000 *  0.937690 *   -5.0944 *  -0.51885    1.000000    
     23 O     c    0.500000 *  0.562310 *   -5.0944 *  -0.51885    1.000000    
     24 O     c    0.000000 *  0.250000 *   -6.2620 *  -0.53683    1.000000    
--------------------------------------------------------------------------------



********************************************************************************
*  General input information                                                   *
********************************************************************************

  Species output for all configurations : 

--------------------------------------------------------------------------------
  Species    Type    Atomic    Atomic    Charge       Radii (Angs)     Library
                     Number     Mass       (e)     Cova   Ionic  VDW   Symbol
--------------------------------------------------------------------------------
    O        Core        8      16.00  -0.536827   0.730  0.000  1.360          
    Ti       Core       22      47.88   1.023877   1.470  0.000  2.190          
--------------------------------------------------------------------------------


  Lattice summation method               =    Ewald          (3-D)
                                         =    Parry          (2-D)
                                         =    Saunders et al (1-D)
  Accuracy factor for lattice sums       =   12.000


  Time limit = Infinity

  Maximum range for interatomic potentials =    100000.000000 Angstroms

  General interatomic potentials :

--------------------------------------------------------------------------------
Atom  Types   Potential         A         B         C         D     Cutoffs(Ang)
  1     2                                                            Min    Max 
--------------------------------------------------------------------------------
Ti   c Ti   c Morse         0.567E-02  1.55      4.19      0.00     0.000 25.000
O    c O    c Morse         0.567E-02  1.55      4.19      0.00     0.000 25.000
O    c Ti   c Morse          1.03      3.64      1.88      0.00     0.000 25.000
--------------------------------------------------------------------------------

********************************************************************************
*  Output for configuration   1                                                *
********************************************************************************


  Components of energy : 

--------------------------------------------------------------------------------
  Interatomic potentials     =         -12.00880879 eV
  Monopole - monopole (real) =         -36.47042075 eV
  Monopole - monopole (recip)=         -45.85927028 eV
  Monopole - monopole (total)=         -82.32969103 eV
--------------------------------------------------------------------------------
  Total lattice energy       =         -94.33849982 eV
--------------------------------------------------------------------------------
  Total lattice energy       =           -9102.2231 kJ/(mole unit cells)
--------------------------------------------------------------------------------


  Number of variables =       69

  Maximum number of calculations  =          1000
  Maximum Hessian update interval =            10
  Maximum step size               =   1.000000000
  Maximum parameter tolerance     =   0.000010000
  Maximum function  tolerance     =   0.000010000
  Maximum gradient  tolerance     =   0.001000000
  Maximum gradient  component     =   0.010000000

  Symmetry not applied to optimisation

  Newton-Raphson optimiser to be used

  BFGS hessian update to be used

  Start of surface optimisation :

  Cycle:      0 Energy:       -94.338500  Gnorm:      0.368649  CPU:    0.023
  ** Hessian calculated **
  Cycle:      1 Energy:       -96.519523  Gnorm:      0.266567  CPU:    0.060
  Cycle:      2 Energy:       -98.506549  Gnorm:      0.133136  CPU:    0.082
  ** Hessian calculated **
  Cycle:      3 Energy:       -98.639349  Gnorm:      0.036271  CPU:    0.113
  Cycle:      4 Energy:       -98.653639  Gnorm:      0.019946  CPU:    0.135
  Cycle:      5 Energy:       -98.677302  Gnorm:      0.031939  CPU:    0.166
  Cycle:      6 Energy:       -98.702711  Gnorm:      0.028716  CPU:    0.193
  Cycle:      7 Energy:       -98.717462  Gnorm:      0.021335  CPU:    0.214
  Cycle:      8 Energy:       -98.751300  Gnorm:      0.036739  CPU:    0.245
  Cycle:      9 Energy:       -98.787640  Gnorm:      0.024829  CPU:    0.272
  Cycle:     10 Energy:       -98.803711  Gnorm:      0.008924  CPU:    0.293
  Cycle:     11 Energy:       -98.811448  Gnorm:      0.012952  CPU:    0.315
  Cycle:     12 Energy:       -98.824450  Gnorm:      0.017779  CPU:    0.341
  ** Hessian calculated **
  Cycle:     13 Energy:       -98.869538  Gnorm:      0.012027  CPU:    0.387
  Cycle:     14 Energy:       -98.906471  Gnorm:      0.003490  CPU:    0.418
  Cycle:     15 Energy:       -98.915520  Gnorm:      0.003069  CPU:    0.444
  Cycle:     16 Energy:       -98.915768  Gnorm:      0.000440  CPU:    0.471
  Cycle:     17 Energy:       -98.915788  Gnorm:      0.000101  CPU:    0.492


  **** Optimisation achieved ****


  Final energy =     -98.91578912 eV
  Final Gnorm  =       0.00001292

  Components of energy : 

--------------------------------------------------------------------------------
  Interatomic potentials     =         -19.29002240 eV
  Monopole - monopole (real) =         -34.04712100 eV
  Monopole - monopole (recip)=         -45.57864572 eV
  Monopole - monopole (total)=         -79.62576672 eV
--------------------------------------------------------------------------------
  Total lattice energy       =         -98.91578912 eV
--------------------------------------------------------------------------------
  Total lattice energy       =           -9543.8616 kJ/(mole unit cells)
--------------------------------------------------------------------------------

  Final fractional/Cartesian coordinates of atoms :

--------------------------------------------------------------------------------
   No.  Atomic        x           y          z          Radius
        Label       (Frac)      (Frac)     (Angs)       (Angs) 
--------------------------------------------------------------------------------
     1  O     c     1.000000    0.750000    6.742706    0.000000
     2  Ti    c     1.000000    0.250000    5.039533    0.000000
     3  Ti    c     0.500000    0.750000    5.510992    0.000000
     4  O     c     0.500000    0.443482    5.344245    0.000000
     5  O     c     0.500000    0.056518    5.344245    0.000000
     6  O     c     1.000000    0.750000    3.959012    0.000000
     7  O     c     1.000000    0.250000    3.091444    0.000000
     8  Ti    c     1.000000    0.750000    2.039430    0.000000
     9  Ti    c     0.500000    0.250000    1.660877    0.000000
    10  O     c     0.500000    0.942923    1.740796    0.000000
    11  O     c     0.500000    0.557077    1.740796    0.000000
    12  O     c     0.000000    0.250000    0.403372    0.000000
    13  O     c     1.000000    0.750000   -1.294272    0.000000
    14  Ti    c     1.000000    0.250000   -2.930327    0.000000
    15  Ti    c     0.500000    0.750000   -2.551775    0.000000
    16  O     c     0.500000    0.442923   -2.631687    0.000000
    17  O     c     0.500000    0.057077   -2.631687    0.000000
    18  O     c     1.000000    0.750000   -3.982371    0.000000
    19  O     c     1.000000    0.250000   -4.849909    0.000000
    20  Ti    c     1.000000    0.750000   -5.930467    0.000000
    21  Ti    c     0.500000    0.250000   -6.401891    0.000000
    22  O     c     0.500000    0.943483   -6.235161    0.000000
    23  O     c     0.500000    0.556517   -6.235161    0.000000
    24  O     c     1.000000    0.250000   -7.633600    0.000000
--------------------------------------------------------------------------------

  Final internal/Cartesian derivatives :

--------------------------------------------------------------------------------
   No.  Atomic          a             b             z           Radius
        Label          (eV)          (eV)       (eV/Angs)      (eV/Angs)
--------------------------------------------------------------------------------
      1 O     c      -0.000000     -0.000000      0.000073      0.000000
      2 Ti    c      -0.000000     -0.000000     -0.000232      0.000000
      3 Ti    c       0.000000      0.000000     -0.000019      0.000000
      4 O     c       0.000000     -0.000001      0.000027      0.000000
      5 O     c       0.000000      0.000001      0.000027      0.000000
      6 O     c      -0.000000     -0.000000     -0.000055      0.000000
      7 O     c      -0.000000      0.000000     -0.000007      0.000000
      8 Ti    c      -0.000000     -0.000000      0.000019      0.000000
      9 Ti    c       0.000000      0.000000     -0.000158      0.000000
     10 O     c      -0.000000      0.000326      0.000095      0.000000
     11 O     c      -0.000000     -0.000326      0.000095      0.000000
     12 O     c       0.000000      0.000000      0.000000      0.000000
     13 O     c      -0.000000      0.000000     -0.000015      0.000000
     14 Ti    c       0.000000      0.000000     -0.000067      0.000000
     15 Ti    c       0.000000      0.000000      0.000205      0.000000
     16 O     c       0.000000      0.000409      0.000017      0.000000
     17 O     c       0.000000     -0.000409      0.000017      0.000000
     18 O     c      -0.000000      0.000000     -0.000226      0.000000
     19 O     c      -0.000000      0.000000      0.000030      0.000000
     20 Ti    c      -0.000000      0.000000     -0.000008      0.000000
     21 Ti    c       0.000000     -0.000000     -0.000019      0.000000
     22 O     c       0.000000      0.000134      0.000004      0.000000
     23 O     c       0.000000     -0.000134      0.000004      0.000000
     24 O     c       0.000000      0.000000      0.000068      0.000000
--------------------------------------------------------------------------------
  Maximum abs         0.000000      0.000409      0.000232      0.000000
--------------------------------------------------------------------------------


  Time to end of optimisation =       0.5199 seconds


  Peak dynamic memory used =       0.62 MB 


  Timing analysis for GULP :

--------------------------------------------------------------------------------
  Task / Subroutine                                          Time (Seconds)
--------------------------------------------------------------------------------
  Calculation of reciprocal space energy and derivatives          0.0680
  Calculation of real space energy and derivatives                0.4469
--------------------------------------------------------------------------------
  Total CPU time                                                  0.5199
--------------------------------------------------------------------------------


  Job Finished at 11:51.59  3rd January    2013                               

